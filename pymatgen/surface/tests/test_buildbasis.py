'''
Created on Dec 1, 2012

@author: WenhaoMIT
'''
import unittest
import numpy as np
from pymatgen.surface.buildbasis import Vaspsurface

class Surftooltest(unittest.TestCase):
        
    def setUp(self):
        self.s=Vaspsurface()
        
    def testbuildbasis(self):
        pg=np.array([[1.0000,0,0,0,0],
            [0,180.0000,0,-1.0000,0],
            [0,180.0000,-0.8660,0.5000,0],
            [0,180.0000,0.8660,0.5000,0],
            [2.0000,180.0000,-0.8660,-0.5000,0],
            [2.0000,180.0000,0.0866,0.0500,0],
            [2.0000,180.0000,0,1.0000,0],
            [3.0000,120.0000,0,0,1.0000],
            [3.0000,240.0000,0,0,1.0000],
            [-3.0000,120.0000,0,0,1.0000],
            [-3.0000,240.0000,0,0,1.0000]])
        
        maxindex=np.array([2])
        
        basis=np.array([[0, 4.8050422055, 0],
                        [4.1612866760, -2.4025211027, 0],
                        [0, 0, 13.1105423350]])
        
        atoms=np.array([[0.33333337611605,0.66666662388395,0.31446725392621],
                        [0.00000004278272,-0.00000004278272,0.64780058725954],
                        [0.66666670944939,0.33333329055061,0.98113392059288],
                        [0.66666668460652,0.33333331539348,0.18553274607380],
                        [0.33333335127319,0.66666664872681,0.51886607940713],
                        [0.00000001793985,-0.00000001793985,0.85219941274047],
                        [0.33333341199576,0.66666658800424,0.01886607940713],
                        [0.00000007866243,-0.00000007866243,0.35219941274046],
                        [0.66666674532909,0.33333325467091,0.68553274607380],
                        [0.00000010350529,-0.00000010350529,0.14780058725954],
                        [0.66666677017196,0.33333322982804,0.48113392059287],
                        [0.33333343683863,0.66666656316137,0.81446725392621],
                        [0.36043307424840,0.02709958060747,0.08333333333333],
                        [0.02709974091507,0.36043291394080,0.41666666666667],
                        [0.69376640758173,0.69376624727413,0.75000000000000],
                        [0.66666672738924,0.63956694518283,0.08333333333333],
                        [0.33333339405591,0.97290027851616,0.41666666666666],
                        [0.00000006072257,0.30623361184949,0.75000000000000],
                        [0.97290041089137,0.33333326168069,0.08333333333333],
                        [0.63956707755804,0.66666659501402,0.41666666666667],
                        [0.30623374422470,-0.00000007165264,0.75000000000000],
                        [0.30623371386341,0.30623363128072,0.25000000000000],
                        [0.97290038053008,0.63956696461405,0.58333333333333],
                        [0.63956704719675,0.97290029794738,0.91666666666666],
                        [0.00000006072257,0.69376626670536,0.25000000000000],
                        [0.66666672738924,0.02709960003870,0.58333333333333],
                        [0.33333339405591,0.36043293337203,0.91666666666666],
                        [0.69376637722044,-0.00000004979251,0.25000000000000],
                        [0.36043304388711,0.33333328354082,0.58333333333333],
                        [0.02709971055378,0.66666661687416,0.91666666666667]])
        
        self.s.transformbasis(basis, atoms,maxindex, pg)
        
               
if __name__ == '__main__':
    unittest.main()